!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["axios-extensions"]={})}(this,(function(t){"use strict";var e=n;function n(t){var e=this;if(e instanceof n||(e=new n),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}function r(t,e,n){var r=e===t.head?new a(n,null,e,t):new a(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function i(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}n.Node=a,n.create=n,n.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},n.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},n.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},n.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)i(this,arguments[t]);return this.length},n.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},n.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},n.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},n.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},n.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},n.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},n.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},n.prototype.map=function(t,e){e=e||this;for(var r=new n,i=this.head;null!==i;)r.push(t.call(e,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(t,e){e=e||this;for(var r=new n,i=this.tail;null!==i;)r.push(t.call(e,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},n.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},n.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},n.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},n.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;var a=[];for(i=0;o&&i<e;i++)a.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(i=0;i<n.length;i++)o=r(this,o,n[i]);return a},n.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{!function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}(n)}catch(t){}const s=Symbol("max"),l=Symbol("length"),u=Symbol("lengthCalculator"),h=Symbol("allowStale"),c=Symbol("maxAge"),f=Symbol("dispose"),p=Symbol("noDisposeOnSet"),v=Symbol("lruList"),d=Symbol("cache"),y=Symbol("updateAgeOnGet"),g=()=>1;const m=(t,e,n)=>{const r=t[d].get(e);if(r){const e=r.value;if(b(t,e)){if(x(t,r),!t[h])return}else n&&(t[y]&&(r.value.now=Date.now()),t[v].unshiftNode(r));return e.value}},b=(t,e)=>{if(!e||!e.maxAge&&!t[c])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[c]&&n>t[c]},w=t=>{if(t[l]>t[s])for(let e=t[v].tail;t[l]>t[s]&&null!==e;){const n=e.prev;x(t,e),e=n}},x=(t,e)=>{if(e){const n=e.value;t[f]&&t[f](n.key,n.value),t[l]-=n.length,t[d].delete(n.key),t[v].removeNode(e)}};class A{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const E=(t,e,n,r)=>{let i=n.value;b(t,i)&&(x(t,n),t[h]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};var S=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[s]=t.max||1/0;const e=t.length||g;if(this[u]="function"!=typeof e?g:e,this[h]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[c]=t.maxAge||0,this[f]=t.dispose,this[p]=t.noDisposeOnSet||!1,this[y]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[s]=t||1/0,w(this)}get max(){return this[s]}set allowStale(t){this[h]=!!t}get allowStale(){return this[h]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[c]=t,w(this)}get maxAge(){return this[c]}set lengthCalculator(t){"function"!=typeof t&&(t=g),t!==this[u]&&(this[u]=t,this[l]=0,this[v].forEach((t=>{t.length=this[u](t.value,t.key),this[l]+=t.length}))),w(this)}get lengthCalculator(){return this[u]}get length(){return this[l]}get itemCount(){return this[v].length}rforEach(t,e){e=e||this;for(let n=this[v].tail;null!==n;){const r=n.prev;E(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[v].head;null!==n;){const r=n.next;E(this,t,n,e),n=r}}keys(){return this[v].toArray().map((t=>t.key))}values(){return this[v].toArray().map((t=>t.value))}reset(){this[f]&&this[v]&&this[v].length&&this[v].forEach((t=>this[f](t.key,t.value))),this[d]=new Map,this[v]=new e,this[l]=0}dump(){return this[v].map((t=>!b(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[v]}set(t,e,n){if((n=n||this[c])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[u](e,t);if(this[d].has(t)){if(i>this[s])return x(this,this[d].get(t)),!1;const o=this[d].get(t).value;return this[f]&&(this[p]||this[f](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[l]+=i-o.length,o.length=i,this.get(t),w(this),!0}const o=new A(t,e,i,r,n);return o.length>this[s]?(this[f]&&this[f](t,e),!1):(this[l]+=o.length,this[v].unshift(o),this[d].set(t,this[v].head),w(this),!0)}has(t){if(!this[d].has(t))return!1;const e=this[d].get(t).value;return!b(this,e)}get(t){return m(this,t,!0)}peek(t){return m(this,t,!1)}pop(){const t=this[v].tail;return t?(x(this,t),t.value):null}del(t){x(this,this[d].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[d].forEach(((t,e)=>m(this,e,!1)))}};function O(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function j(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var k=Object.prototype.toString;function D(t){return"[object Array]"===k.call(t)}function R(t){return void 0===t}function B(t){return null!==t&&"object"==typeof t}function L(t){if("[object Object]"!==k.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function N(t){return"[object Function]"===k.call(t)}function T(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),D(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}var P={isArray:D,isArrayBuffer:function(t){return"[object ArrayBuffer]"===k.call(t)},isBuffer:function(t){return null!==t&&!R(t)&&null!==t.constructor&&!R(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:B,isPlainObject:L,isUndefined:R,isDate:function(t){return"[object Date]"===k.call(t)},isFile:function(t){return"[object File]"===k.call(t)},isBlob:function(t){return"[object Blob]"===k.call(t)},isFunction:N,isStream:function(t){return B(t)&&N(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:T,merge:function t(){var e={};function n(n,r){L(e[r])&&L(n)?e[r]=t(e[r],n):L(n)?e[r]=t({},n):D(n)?e[r]=n.slice():e[r]=n}for(var r=0,i=arguments.length;r<i;r++)T(arguments[r],n);return e},extend:function(t,e,n){return T(e,(function(e,r){t[r]=n&&"function"==typeof e?function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}(e,n):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}};function C(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var G=function(t,e,n){if(!e)return t;var r;if(n)r=n(e);else if(P.isURLSearchParams(e))r=e.toString();else{var i=[];P.forEach(e,(function(t,e){null!=t&&(P.isArray(t)?e+="[]":t=[t],P.forEach(t,(function(t){P.isDate(t)?t=t.toISOString():P.isObject(t)&&(t=JSON.stringify(t)),i.push(C(e)+"="+C(t))})))})),r=i.join("&")}if(r){var o=t.indexOf("#");-1!==o&&(t=t.slice(0,o)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t};function F(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=G.apply(void 0,t),r=n.split("?"),i=r[0],o=r[1];if(o){var a=o.split("&");return"".concat(i,"?").concat(a.sort().join("&"))}return n}t.Cache=S,t.cacheAdapterEnhancer=function(t,e){var n=this;void 0===e&&(e={});var r=e.enabledByDefault,i=void 0===r||r,o=e.cacheFlag,a=void 0===o?"cache":o,s=e.defaultCache,l=void 0===s?new S({maxAge:3e5,max:100}):s;return function(e){var r,o=e.url,s=e.method,u=e.params,h=e.paramsSerializer,c=e.forceUpdate,f=void 0!==e[a]&&null!==e[a]?e[a]:i;if("get"===s&&f){var p=(r=f).set&&r.get&&r.del&&"function"==typeof r.get&&"function"==typeof r.set&&"function"==typeof r.del?f:l,v=F(o,u,h),d=p.get(v);return!d||c?(d=O(n,void 0,void 0,(function(){var n;return j(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t(e)];case 1:return[2,r.sent()];case 2:throw n=r.sent(),p.del(v),n;case 3:return[2]}}))})),p.set(v,d),d):(process&&"info"===process.env.LOGGER_LEVEL&&console.info("[axios-extensions] request cached by cache adapter --\x3e url: ".concat(v)),d)}return t(e)}},t.retryAdapterEnhancer=function(t,e){var n=this;void 0===e&&(e={});var r=e.times,i=void 0===r?2:r;return function(e){return O(n,void 0,void 0,(function(){var n,r,o,a,s=this;return j(this,(function(l){return n=e.retryTimes,r=void 0===n?i:n,!1,o=0,a=function(){return O(s,void 0,void 0,(function(){var n;return j(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t(e)];case 1:return[2,i.sent()];case 2:if(n=i.sent(),r===o)throw n;return o++,process&&"info"===process.env.LOGGER_LEVEL&&console.info("[axios-extensions] request start retrying --\x3e url: ".concat(e.url," , time: ").concat(o)),[2,a()];case 3:return[2]}}))}))},[2,a()]}))}))}},t.throttleAdapterEnhancer=function(t,e){var n=this;void 0===e&&(e={});var r=e.threshold,i=void 0===r?1e3:r,o=e.cache,a=void 0===o?new S({max:10}):o;return function(e){var r=e.url,o=e.method,s=F(r,e.params,e.paramsSerializer),l=Date.now(),u=a.get(s)||{timestamp:l};if("get"===o){if(l-u.timestamp<=i){var h=u.value;if(h)return"info"===process.env.LOGGER_LEVEL&&console.info("[axios-extensions] request cached by throttle adapter --\x3e url: ".concat(s)),h}return function(e,r){var i=O(n,void 0,void 0,(function(){var n,i;return j(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t(r)];case 1:return n=o.sent(),a.set(e,{timestamp:Date.now(),value:Promise.resolve(n)}),[2,n];case 2:throw i=o.sent(),a.del(e),i;case 3:return[2]}}))}));return a.set(e,{timestamp:Date.now(),value:i}),i}(s,e)}return t(e)}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=axios-extensions.min.js.map
